---
layout      : single
title       : "âš¾Chapter01 KBO íƒ€ì OPS ì˜ˆì¸¡ 3 - ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ë°©ë²•, ì •ë¦¬"
categories  : 
  - Dacon
tag         : [dacon, python, analysis] 
toc : true
toc_label: "Contents"
toc_icon	: "list"
toc_sticky : True
author_profile : false
sidebar:
    nav : "docs"
typora-copy-images-to: ..\images\2022-04-08-dacon-2st
---
<img src="/images/2022-04-08-dacon-1st/image-20220408102310504.png" alt="image-20220408102349708" style="zoom:50%;" />
{: .text-center}

* [âš¾Chapter01 KBO íƒ€ì OPS ì˜ˆì¸¡ 1 - ë¬¸ì œ ì •ì˜, íƒìƒ‰ì  ë°ì´í„° ë¶„ì„](https://msio900.github.io/dacon/dacon-1st/)
* [âš¾Chapter01 KBO íƒ€ì OPS ì˜ˆì¸¡ 2 - ë°ì´í„° ì „ì²˜ë¦¬, ëª¨ë¸ êµ¬ì¶•ê³¼ ê²€ì¦](https://msio900.github.io/dacon/dacon-2st/)


## 5_ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ë°©ë²•[ğŸ“‘](#contents)<a id='5'></a>

* ì§€ê¸ˆê¹Œì§€ 2019 KBO ìƒë°˜ê¸° íƒ€ìë“¤ì˜ OPS ì„±ì ì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•œ ì‘ì—… ì§„í–‰
  * ë°ì´í„° ì´í•´
  * ì „ì²˜ë¦¬
  * ëª¨ë¸ë§
* ì´ëŸ¬í•œ ê³¼ì •ì„ ì ìš©í•˜ë©´ ê³§ë°”ë¡œ 2019 ìƒë°˜ê¸° íƒ€ìì˜ ì˜ˆì¸¡ OPS ê°’ì„ ë„ì¶œ ê°€ëŠ¥
* í•˜ì§€ë§Œ ëŒ€íšŒ ìˆ˜ìƒì„ ìœ„í•´ì„œëŠ” ë‹¨ìˆœíˆ ì˜ˆì¸¡ OPS ê°’ë§Œ ë„ì¶œí•˜ëŠ” ê²ƒ ìœ¼ë¡œëŠ” ë¶€ì¡±í•˜ê¸°ì— ë„ì¶œëœ ì˜ˆì¸¡ OPS ê°’ì´ ì‹¤ì œ OPSì™€ ìœ ì‚¬í•´ì•¼ í•¨
* ì˜ˆì¸¡ëœ OPS ì™€ ì‹¤ì œ OPSì˜ ìˆ˜ì¹˜ê°€ ë¹„ìŠ·í• ìˆ˜ë¡ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ìš°ìˆ˜í•˜ë‹¤ê³  í‰ê°€

### 5_1 ì•™ìƒë¸”

* ëª¨ë¸ì˜ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ë„ë¦¬ ì´ìš©ë˜ëŠ” ë°©ë²• `ì•™ìƒë¸”`

* `ì•™ìƒë¸”`ì€ ì—¬ëŸ¬ ëª¨ë¸ì˜ ê²°ê³¼ë¥¼ ì¢…í•©í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì˜ë¯¸

  * ì—¬ëŸ¬ ëª¨ë¸ì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë”í•´ í‰ê· ì„ ë‚´ë©´ í•˜ë‚˜ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì¼ ë•Œê°€ ë§ìŒ.
  * ê° ëª¨ë¸ì˜ ê²°ë¡ ì„ ì¢…í•©í•´ ë” ë³´í¸ì ì¸ ê²°ê³¼ë¥¼ ì´ëŒì–´ë‚´ê¸° ë•Œë¬¸

* ì´ë²ˆ ëŒ€íšŒ ì—­ì‹œ ì•™ìƒë¸” ê¸°ë²•ì„ ì´ìš©í•´ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì§ˆ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸

* ë³´í†µ ì„œë¡œ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì´ë©´ì„œ ë¹„ìŠ·í•œ ì„±ëŠ¥ì„ ë³´ì´ëŠ” ê²°ê³¼ë¥¼ ê²°í•©í•  ë•Œ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì„

* `ë¦¿ì§€` íšŒê·€ ëª¨ë¸ê³¼ `ë¼ì˜` íšŒê·€ ëª¨ë¸ì€ ë™ì¼í•œ ì„ í˜•íšŒê·€ ëª¨ë¸ì´ë¯€ë¡œ ì„±ëŠ¥ì´ ì¢€ ë” ì¢‹ì•˜ë˜ ë¼ì˜ë¥¼ ì‚¬ìš©í•˜ê³ , `XGBoost`ëŠ” ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì— ë¹„í•´ ì„±ëŠ¥ì´ ì¢‹ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ `ë¼ì˜`ì™€ `ëœë¤ í¬ë ˆìŠ¤íŠ¸`ë¥¼ ì´ìš©í•´ ì•™ìƒë¸”ì„ ì§„í–‰

* ë‘ ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ì„ í‰ê·  ë‚´ì–´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ì— ì ìš©í•œ ì´í›„ WRMSEì˜ ê°’ì„ ë¹„êµ

* ë‘ ëª¨ë¸ì˜ í‰ê· ì„ ì´ìš©í•´ ì•™ìƒë¸”

  ```python
  print('OBP model averaging: ',
        wrmse(OBP_test['OBP'], OBP_test['AB'], (Lasso_OBP + RF_OBP) / 2))
  print('SLG model averaging: ',
        wrmse(SLG_test['SLG'], OBP_test['AB'], (Lasso_SLG + RF_SLG) / 2))
  ```

      OBP model averaging:  0.33245746520105823
      SLG model averaging:  0.6684541138633259

* ë‘ ëª¨ë¸ì˜ í‰ê· ì„ ì´ìš©í•´ ì•™ìƒë¸”í•œ ê²°ê³¼, ì¶œë£¨ìœ¨ì€ 0.332ì˜ WRMSE ê°’ì„ ë³´ì—¬ì£¼ì–´ ì •í™•ë„ê°€ ì†Œí­ í•˜ë½í–ˆì§€ë§Œ ì¥íƒ€ìœ¨ì€ 0.668ì˜ WRMSE ê°’ì„ ë³´ì—¬ ì •í™•ë„ê°€ ì†Œí­ ìƒìŠ¹

* `ì•™ìƒë¸”`ì˜ ì„±ëŠ¥ í–¥ìƒ íš¨ê³¼ë¥¼ ë†’ì´ë ¤ë©´ ëª¨ë¸ ê°„ ì„±ëŠ¥ì´ ë¹„ìŠ·í•´ì•¼ í•˜ëŠ”ë° ì¥íƒ€ìœ¨ì€ ë¼ì˜ ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì„œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì˜¨ ê²ƒìœ¼ë¡œ ì¶”ì • ê°€ëŠ¥

### 5_2 ë‹¨ìˆœí™”ëœ ëª¨ë¸ ìƒì„±

* ì•ì—ì„œ ë³€ìˆ˜ ì„ íƒì„ ì§„í–‰í•  ë•Œ ê° ì§€í‘œê°€ ì„œë¡œ ë†’ì€ ìƒê´€ê³„ìˆ˜ë¥¼ ì§€ë‹ˆê³  ìˆìŒì„ í™•ì¸

* ì´ì— ë”°ë¼ ì´ë²ˆ ë¶„ì„ì—ì„œëŠ” OBPì™€ SLGì˜ ì˜ˆì¸¡ì— ê°€ì¥ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°ë˜ëŠ” ë³€ìˆ˜ë¡œ OBPì™€ SLGë§Œ ì‚¬ìš©

* í•˜ì§€ë§Œ ë‹¤ë¥¸ ë³€ìˆ˜ë¥¼ ì¶”ê°€ë¡œ ì´ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ëª¨ë¸ ì„±ëŠ¥ì— ì •í™•íˆ ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹ ì§€ëŠ” ì•Œìˆ˜ ì—†ìŒ 

* OBP ì˜ˆì¸¡ ëª¨ë¸ì— ë‹¤ë¥¸ ë³€ìˆ˜ë“¤ì„ í¬í•¨í•  ê²½ìš° ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ í•œë²ˆ í™•ì¸

* êµ¬ì²´ì ìœ¼ë¡œ ë³¼ë„·(BB). ë£¨íƒ€(TB), íƒ€ì (RBI)ì„ ì¶”ê°€í•´ ëª¨ë¸ì„ êµ¬ì„±í–ˆì„ ë•Œì˜ ê²°ê³¼ë¥¼ ë´„

* ì—¬ê¸°ì„œ ëª¨ë¸ì€ ëœë¤ í¬ë ˆìŠ¤íŠ¸ë§Œ ì´ìš©í•˜ê³  ê³¼ê±° 1ê°œ ì—°ë„ì˜ lag ë³€ìˆ˜ë§Œ ìƒì„±í•´ ê²°ê³¼ë¥¼ ë¹„êµ

* ë‹¤ìŒ ê³¼ì •ì€ ë³¼ë„·(BB), ë£¨íƒ€(TB), íƒ€ì (BRI) ê°ê°ì˜ lag ë³€ìˆ˜ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì‹œí–‰í•œ ì „ì²˜ë¦¬ ì½”ë“œ

* lag ë³€ìˆ˜ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì „ì²˜ë¦¬

  ```python
  # ì „ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ê³³ì— ì €ì¥
  sum_hf_yr_OBP_origin = sum_hf_yr_OBP.copy()
  
  # ì „ì²´ í¬ìƒíƒ€ ê³„ì‚°
  regular_season_df['SF'] = \
      regular_season_df[['H','BB','HBP']].sum(axis=1) / regular_season_df['OBP'] - \
      regular_season_df[['AB','BB','HBP']].sum(axis=1)
  regular_season_df['SF'].fillna(0, inplace = True)
  regular_season_df['SF'] = regular_season_df['SF'].apply(lambda x : round(x,0))
  
  # í•œ íƒ€ìˆ˜ë‹¹ í‰ê·  í¬ìƒíƒ€ ê³„ì‚° í›„ í•„ìš”í•œ ê²ƒë§Œ ì¶”ì¶œ
  regular_season_df['SF_1'] = regular_season_df['SF'] / regular_season_df['AB']
  regular_season_df_SF = regular_season_df[['batter_name','year','SF_1']]
  
  #day_by_dayì—ì„œ ì—°ë„ë³„ ì„ ìˆ˜ì˜ ì‹œì¦Œ ì „ë°˜ê¸° ì¶œë£¨ìœ¨ê³¼ ê´€ë ¨ëœ ì„±ì  í•© êµ¬í•˜ê¸° + BB, RBI ì¶”ê°€
  sum_hf_yr_OBP = \
      day_by_day_df.loc[day_by_day_df['date'] <= 7.18].groupby(['batter_name','year'])[
      'AB','H','BB','HBP','RBI', '2B', '3B', 'HR'].sum().reset_index()
  #day_by_dayì™€ regular seasonì—ì„œ êµ¬í•œ í¬ìƒíƒ€ ê´€ë ¨ ë°ì´í„°ë¥¼ í•©ì¹˜ê¸°
  sum_hf_yr_OBP = sum_hf_yr_OBP.merge(regular_season_df_SF, how = 'left',
                                      on=['batter_name','year'])
  
  # í•œ íƒ€ìˆ˜ë‹¹ í‰ê·  í¬ìƒíƒ€ ê³„ì‚°
  sum_hf_yr_OBP['SF'] = \
      (sum_hf_yr_OBP['SF_1']*sum_hf_yr_OBP['AB']).apply(lambda x: round(x,0))
  sum_hf_yr_OBP.drop('SF_1',axis = 1, inplace = True)
  
  # ì „ë°˜ê¸° OBP(ì¶œë£¨ìœ¨ ê³„ì‚°)
  sum_hf_yr_OBP['OBP'] = sum_hf_yr_OBP[['H', 'BB', 'HBP']].sum(axis = 1) / \
                         sum_hf_yr_OBP[['AB', 'BB', 'HBP','SF']].sum(axis = 1)
  sum_hf_yr_OBP['OBP'].fillna(0, inplace = True)
  
  # TB ê³„ì‚°
  sum_hf_yr_OBP['TB'] =  sum_hf_yr_OBP['H'] + sum_hf_yr_OBP['2B']*2 + \
                         sum_hf_yr_OBP['3B']*3 + sum_hf_yr_OBP['HR']*4
  sum_hf_yr_OBP = sum_hf_yr_OBP[['batter_name','year','AB','OBP', 'BB', 'TB', 'RBI']]
  
  # ë‚˜ì´ ì¶”ê°€
  sum_hf_yr_OBP = sum_hf_yr_OBP.merge(regular_season_df[['batter_name','year','age']],
                                      how = 'left', on=['batter_name','year'])
  
  # í‰ê·  OBP ì¶”ê°€
  sum_hf_yr_OBP = sum_hf_yr_OBP.merge(player_OBP_mean[['batter_name', 'mean_OBP']],
                                      how ='left', on="batter_name")
  sum_hf_yr_OBP = \
      sum_hf_yr_OBP.loc[~sum_hf_yr_OBP['mean_OBP'].isna()].reset_index(drop=True)
  ```

* OBPë§Œ ì´ìš©í–ˆì„ ë•Œ ëª¨ë¸ë§ì— ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜ë¥¼ `feature_list_1` ì— ì €ì¥í•˜ê³  ë³¼ë„·(BB). ë£¨íƒ€ (TB), íƒ€ì (BRI)ì„ ì¶”ê°€í•´ ëª¨ë¸ë§í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜ë¥¼ `feature_list_2`ì— ì €ì¥

* ë‹¨ìˆœ ë¹„êµë¥¼ ìœ„í•´ ê²°ì¸¡ì¹˜ëŠ” ë”°ë¡œ ì²˜ë¦¬í•˜ì§€ ì•Šì„ ê²ƒì´ë©° ê²°ì¸¡ì¹˜ê°€ í¬í•¨ëœ ë°ì´í„°ëŠ” ì œê±°í•˜ê³  ëª¨ë¸ë§ ì‘ì—…ì„ ì§„í–‰

* ëª¨ë¸ë§ì— ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸ ì§€ì •

  ```python
  # ê° ë³€ìˆ˜ì— ëŒ€í•œ 1ë…„ ì „ ì„±ì  ìƒì„±
  sum_hf_yr_OBP = lag_function(sum_hf_yr_OBP, "BB", 1)
  sum_hf_yr_OBP = lag_function(sum_hf_yr_OBP, "TB", 1)
  sum_hf_yr_OBP = lag_function(sum_hf_yr_OBP, "RBI", 1)
  sum_hf_yr_OBP = lag_function(sum_hf_yr_OBP, "OBP", 1)
  
  sum_hf_yr_OBP = sum_hf_yr_OBP.dropna() # ê²°ì¸¡ì¹˜ í¬í•¨í•œ í–‰ ì œê±°
  
  # ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸ ì§€ì •
  feature_list_1 = ['age', 'lag1_OBP', 'mean_OBP']
  feature_list_2 = ['age', 'lag1_BB', 'lag1_TB', 'lag1_RBI','lag1_OBP', 'mean_OBP']
  ```

* `OBP_RF_models_1` ì€ `age`ì™€ `mean_OBP`, 1ë…„ ì „ OBP ê°’ì„ ì´ìš©í•´ í•™ìŠµí•œ ëª¨ë¸

* `OBP_RF_ models_2`ëŠ” `OBP_RF_models_1` ì—ì„œ ì‚¬ìš©í•œ ë³€ìˆ˜ì— OBPì™€ ë†’ì€ ìƒê´€ê´€ê³„ë¥¼ ë³´ì˜€ë˜ 1ë…„ ì „ RBI, TB. BB ê°’ì„ ë³€ìˆ˜ë¡œ ì¶”ê°€í•´ í•™ìŠµí•œ ëª¨ë¸

*  ë‘ ëª¨ë¸ ë‹¤ GridSearchCVë¥¼ í†µí•´ ìµœì  ì˜ ëª¨ìˆ˜ë¥¼ ì„¤ì •í•¨

* í•™ìŠµ

  ```python
  # í•™ìŠµì‹œí‚¬ ë°ì´í„° 30íƒ€ìˆ˜ ì´ìƒë§Œ í•™ìŠµ
  sum_hf_yr_OBP= sum_hf_yr_OBP.loc[sum_hf_yr_OBP['AB']>=30] 
  
  # 2018ë…„ testë¡œ ë‚˜ëˆ„ê³  ë‚˜ë¨¸ì§€ëŠ” í•™ìŠµ
  OBP_train = sum_hf_yr_OBP.loc[sum_hf_yr_OBP['year'] != 2018]
  OBP_test = sum_hf_yr_OBP.loc[sum_hf_yr_OBP['year'] == 2018]
  
  # grid searchë¥¼ ì´ìš©í•´ í•™ìŠµí•œë‹¤.
  OBP_RF_models_1 = {
      'RF': GridSearchCV(
          RandomForestRegressor(random_state=42), param_grid=RF_params, n_jobs=-1
          ).fit(OBP_train.loc[:,feature_list_1], OBP_train['OBP']).best_estimator_}
  
  OBP_RF_models_2 = {
      'RF': GridSearchCV(
          RandomForestRegressor(random_state=42), param_grid=RF_params, n_jobs=-1
          ).fit(OBP_train.loc[:,feature_list_2], OBP_train['OBP']).best_estimator_}
  ```

* ê²°ê³¼ë¥¼ ë¹„êµí–ˆì„ ë•Œ ë‘ ëª¨ë¸ ê°„ WRMSE ê°’ì˜ ì°¨ì´ê°€ 0.002ë¡œ ë§¤ìš° ë¯¸ì„¸í•¨

* ë‘ ëª¨ë¸ì´ ë¹„ìŠ·í•œ ì„±ëŠ¥ì„ ë³´ì´ê³  ìˆë‹¤ë©´ ë¶„ì„ì„ ì§„í–‰í•  ë•Œ ê°€ëŠ¥í•œ ë³€ìˆ˜ê°€ ì ì€ ëª¨ë¸ì„ ì„ íƒí•´ì•¼ í•¨

* ì‹¤ì œ 2019ë…„ ìƒë°˜ê¸° ë°ì´í„°ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì˜ˆì¸¡ì„ ì§„í–‰í•  ë•Œ ë³€ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ê³¼ì í•© ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸

* ì •ë°€í•˜ê²Œ ì˜ˆì¸¡ì„ í•˜ë ¤ë©´ ìµœëŒ€í•œ ë‹¨ìˆœí™”ëœ ëª¨ë¸ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ í•„ìš”

* í•„ìš”í•˜ë‹¤ë©´ SLGë‚˜ ë‹¤ë¥¸ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ ë‹¤ì–‘í•œ ì‹¤í—˜ì„ í•´ë³¼ ìˆ˜ ìˆìŒ

* ë‘ ëª¨ë¸ì˜ WRMSE ë¹„êµ

  ```python
  # ì˜ˆì¸¡
  RF_OBP_1 = OBP_RF_models_1['RF'].predict(OBP_test.loc[:,feature_list_1])
  RF_OBP_2 = OBP_RF_models_2['RF'].predict(OBP_test.loc[:,feature_list_2])
  
  # wrmse ê³„ì‚°
  wrmse_score = [wrmse(OBP_test['OBP'],OBP_test['AB'],RF_OBP_1) ,
                 wrmse(OBP_test['OBP'],OBP_test['AB'],RF_OBP_2)]
  x_lab = ['simple', 'complicate']
  
  plt.bar(x_lab, wrmse_score)
  plt.title('WRMSE of OBP', fontsize=20)
  plt.xlabel('model', fontsize=18)
  plt.ylabel('', fontsize=18)
  plt.ylim(0,0.5)
  # ë§‰ëŒ€ê·¸ë˜í”„ ìœ„ì— ê°’ì„ í‘œì‹œí•´ì¤€ë‹¤.
  for i, v in enumerate(wrmse_score):
      plt.text(i-0.1, v + 0.01, str(np.round(v,3))) # x ì¢Œí‘œ, yì¢Œí‘œ, í…ìŠ¤íŠ¸ í‘œì‹œ
  plt.show()
  ```

  ![image-20220408125211914](/images/2022-04-08-dacon-3rd/image-20220408125211914.png)

* ìµœì¢… ì œì¶œì„ ìœ„í•œ ì›ë˜ ë°ì´í„° ë³µêµ¬

  ```python
  # ìµœì¢… ì œì¶œì„ ìœ„í•œ ì›ë˜ ë°ì´í„° ë³µêµ¬ 
  sum_hf_yr_OBP = sum_hf_yr_OBP_origin.copy()
  ```

### 5_3 í…ŒìŠ¤íŠ¸ ë°ì´í„° ì •ì œ

* ì§€ê¸ˆê¹Œì§€ëŠ” í•™ìŠµì˜ ì„±ëŠ¥ì„ í‰ê°€í•˜ê¸° ìœ„í•´ ì‹¤ì œ ëŒ€íšŒì˜ ì˜ˆì¸¡ ëŒ€ìƒì¸ 2019 ì‹œì¦Œì´ ì•„ë‹Œ 2018 ì‹œì¦Œì˜ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë¸ë§ì„ ì§„í–‰

* ì§€ê¸ˆë¶€í„°ëŠ” ì‹¤ì œë¡œ ì´ ëŒ€íšŒì— ê²°ê³¼ë¬¼ì„ ì œì¶œí•˜ê¸° ìœ„í•œ 2019 ì‹œì¦Œ ëŒ€ìƒì˜ ëª¨ë¸ë§ ì‘ì—…ì„ ì§„í–‰

* ì£¼ì–´ì§„ submission.csv íŒŒì¼ì— 2019ë…„ ì„±ì ì„ ì˜ˆì¸¡í•  ì„ ìˆ˜ ëª…ë‹¨ì´ ìˆìœ¼ë¯€ë¡œ ì´ íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ í•´ë‹¹ ì„ ìˆ˜ì— ëŒ€í•´ í•™ìŠµ ë°ì´í„°ì™€ ê°™ì´ ì „ì²˜ë¦¬ë¥¼ ì§„í–‰

* ê·¸ë¦¬ê³  ë™ì¼í•œ submission íŒŒì¼ì„ 2ê°œë¡œ ë³µì‚¬í•´ í•˜ë‚˜ëŠ” OBP, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” SLG ì„±ì ì„ ì˜ˆì¸¡í•˜ê³  ë‘ ê°œì˜ ì˜ˆì¸¡ ê°’ì„ ë”í•´ ìµœì¢… OPSë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë°©ì‹ì„ ì´ìš©

* 2019ë…„ ë°ì´í„° ì „ì²˜ë¦¬

  ```python
  submission = pd.read_csv('C:/dacon/ch01/dataset/submission.csv')
  submission['year'] = 2019 # ì—°ë„ ê¸°ì…
  
  # 2019ë…„ì˜ Age(ë‚˜ì´) ê³„ì‚°
  batter_year_born = regular_season_df[['batter_id','batter_name','year_born']].copy()
  # ì¤‘ë³µì„ ìˆ˜ ì œê±°
  batter_year_born = batter_year_born.drop_duplicates().reset_index(drop=True) 
  
  submission = submission.merge(batter_year_born, how='left',
                                on=['batter_id', 'batter_name'])
  submission['age'] = submission['year'] - \
                      submission['year_born'].apply(lambda x: int(x[:4]))
  submission.head()
  ```

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: center;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>year</th>
        <th>year_born</th>
        <th>age</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>2019</td>
        <td>1992ë…„ 08ì›” 11ì¼</td>
        <td>27</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>2019</td>
        <td>1993ë…„ 06ì›” 09ì¼</td>
        <td>26</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>2019</td>
        <td>1992ë…„ 01ì›” 10ì¼</td>
        <td>27</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>2019</td>
        <td>1985ë…„ 08ì›” 18ì¼</td>
        <td>34</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>2019</td>
        <td>1999ë…„ 07ì›” 29ì¼</td>
        <td>20</td>
      </tr>
    </tbody>
  </table>

* ì£¼ì–´ì§„ íŒŒì¼ì„ ì½ì–´ì˜¨ í›„ ë‚˜ì´ ë³€ìˆ˜ ìƒì„±

* ì´ì œ ì´ ë°ì´í„°ë¥¼ ë‘ ê°œë¡œ ë³µì‚¬í•´ ì¶œë£¨ìœ¨ê³¼ ì¥íƒ€ìœ¨ ê°ê°ì— ëŒ€í•œ ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ì§„í–‰

* ì¶œë£¨ìœ¨ë¶€í„° ì„ ìˆ˜ë³„ë¡œ ê³¼ê±° ì„±ì  ë° í‰ê·  ì„±ì  ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¶”ê°€

* ë°ì´í„°ë¥¼ ë³µì‚¬


  ```python
  # submission OBP, SLG íŒŒì¼ 2ê°œ ë§Œë“¤ì–´ í•©ì¹˜ê¸° 
  submission_OBP = submission.copy()
  submission_SLG = submission.copy()
  ```

#### OBP

* ì•ì„œ ì „ì²˜ë¦¬í•œ `sum_hf_yr_0BP`ë¥¼ ì´ìš©

* OPS ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì œì¶œí•´ì•¼ í•  ì„ ìˆ˜ë“¤ì˜ í‰ê·  ì„±ì ì„ ë¶ˆëŸ¬ì˜¤ê³  ê³¼ê±°ì˜ ì„±ì ì„ ìƒì„±

* ê³¼ê±° ì¶œë£¨ìœ¨ì„ ìƒì„±

  ```python
  # ì•ì„œ ì „ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ ì´ìš©í•´ í‰ê·  ì„±ì  ê¸°ì…
  submission_OBP = submission_OBP.merge(
      sum_hf_yr_OBP[['batter_name','mean_OBP']].drop_duplicates().reset_index(drop=True),
      how = 'left', on ='batter_name')
  
  # ì•ì„œ ì „ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ ì´ìš©í•´ ê³¼ê±° ì„±ì  ê°’ ì±„ìš°ê¸°
  for i in [1,2,3]:
      temp_lag_df = sum_hf_yr_OBP.loc[
          (sum_hf_yr_OBP['year'] == (2019 - i)) &
          (sum_hf_yr_OBP['AB']>=30),['batter_name','OBP']].copy()
      temp_lag_df.rename(columns={'OBP':'lag'+str(i)+'_OBP'}, inplace=True)
      submission_OBP = submission_OBP.merge(temp_lag_df, how='left', on='batter_name')
  
  submission_OBP.head()
  ```

  


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>year</th>
        <th>year_born</th>
        <th>age</th>
        <th>mean_OBP</th>
        <th>lag1_OBP</th>
        <th>lag2_OBP</th>
        <th>lag3_OBP</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>2019</td>
        <td>1992ë…„ 08ì›” 11ì¼</td>
        <td>27</td>
        <td>0.337880</td>
        <td>0.423611</td>
        <td>0.285714</td>
        <td>0.222222</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>2019</td>
        <td>1993ë…„ 06ì›” 09ì¼</td>
        <td>26</td>
        <td>NaN</td>
        <td>NaN</td>
        <td>NaN</td>
        <td>NaN</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>2019</td>
        <td>1992ë…„ 01ì›” 10ì¼</td>
        <td>27</td>
        <td>NaN</td>
        <td>NaN</td>
        <td>NaN</td>
        <td>NaN</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>2019</td>
        <td>1985ë…„ 08ì›” 18ì¼</td>
        <td>34</td>
        <td>0.358187</td>
        <td>0.328990</td>
        <td>0.386076</td>
        <td>0.441860</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>2019</td>
        <td>1999ë…„ 07ì›” 29ì¼</td>
        <td>20</td>
        <td>0.356164</td>
        <td>0.355685</td>
        <td>NaN</td>
        <td>NaN</td>
      </tr>
    </tbody>
  </table>

  </div>

* ì²˜ë¦¬ë¥¼ í•˜ë‹¤ë³´ë‹ˆ ê²°ì¦‰ì¹˜ê°€ ë°œìƒ

* ì•ì—ì„œëŠ” ê²°ì¦‰ì¹˜ë¥¼ ì‚­ì œí•˜ê³  ëª¨ë¸ë§

* í•˜ì§€ë§Œ ì§€ê¸ˆì€ ê²°ì¸¡ì¹˜ ì‚­ì œ ë°©ì‹ì„ ì´ìš©í•˜ì§€ ëª»í•¨

* ê²°ì¸¡ì¹˜ë¥¼ ì‚­ì œí•˜ë©´ ëŒ€íšŒì— ì œì¶œí•´ì•¼ í•  ì„ ìˆ˜ì˜ ë°ì´í„° ìì²´ê°€ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸

* ê²°ì¸¡ì¹˜ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ë©´ ì¢‹ì„ì§€ íŒë‹¨í•˜ê¸° ìœ„í•´ í‰ê·  ì„±ì ì´ ê²°ì¸¡ì¹˜ì¸ ì„ ìˆ˜ë“¤ì„ ë´„.

* ì¶œë£¨ìœ¨ì— ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ì„ ìˆ˜


  ```python
  submission_OBP['batter_name'].loc[submission_OBP['mean_OBP'].isna()].values
  ```


      array(['ê°•êµ¬ì„±', 'ê°•ë¯¼êµ­', 'ê°•ìƒì›', 'ê³ ëª…ì„±', 'ê¹€ì‘ë¯¼', 'ê¹€ì¢…ë•', 'ê¹€ì£¼ì°¬', 'ê¹€ì² í˜¸', 'ê¹€íƒœì—°',
             'ê¹€íƒœì§„', 'ê¹€í˜•ì¤€', 'ë‚˜ì›íƒ', 'ë‚¨íƒœí˜', 'ë°•ê´‘ì—´', 'ë°•ê¸°í˜', 'ë°±ë¯¼ê¸°', 'ìƒŒì¦ˆ', 'ì‹ ë²”ìˆ˜',
             'ì‹ ì„±í˜„', 'ì–‘ì¢…ë¯¼', 'ìœ¤ì •ìš°', 'ì´ë™í›ˆ', 'ì´ë²”í˜¸', 'ì´ë³‘íœ˜', 'ì´ì„±ê³¤', 'ì´ì¸í–‰', 'ì´ì¢…ìš±',
             'ì´ì§„ì˜', 'ì´ì°½ì§„', 'ì¥ìŠ¹í˜„', 'ì¥ì‹œìœ¤', 'ì „ë¯¼ì¬', 'ì „ë³‘ìš°', 'ì •ê²½ìš´', 'ì •ì„±í›ˆ', 'ì¡°í™ì„',
             'ìµœì›ì œ', 'í™ì°½ê¸°'], dtype=object)

* ìœ„ì™€ ê°™ì´ í‰ê·  ì„±ì ì´ ê²°ì¸¡ì¹˜ì¸ ì„ ìˆ˜ì˜ ëª…ë‹¨ì„ ë§Œë“¦

* í•´ë‹¹ ì„ ìˆ˜ë“¤ì€ ì´ 4ê°€ì§€ì˜ ì¼€ì´ìŠ¤ë¡œ ë¶„ë¥˜í•´ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ í•˜ê² ìŠµë‹ˆë‹¤.

* case 1

  * ì²« ë²ˆì§¸ ì¼€ì´ìŠ¤ëŠ” ì •ê·œì‹œì¦Œ ë°ì´í„°(regular_season_Batter)ì—ëŠ” ìˆìœ¼ë‚˜ ì¼ë³„ ë°ì´í„° (Regular_Season_Batter_Day)ì—ëŠ” ê¸°ë¡ì´ ì—†ì–´ ê²°ì¸¡ì¹˜ê°€ ìƒê¸´ ì„ ìˆ˜

  * ì´ ì‚¬ë¡€ì— í•´ë‹¹í•˜ëŠ” ì„ ìˆ˜ëŠ” ê¹€ì£¼ì°¬, ì´ë²”í˜¸

  * ì´ ê²½ìš°ëŠ” ì •ê·œì‹œì¦Œ ë°ì´í„°ë¥¼ ì´ìš©í•´ ê²°ì¸¡ì¹˜ë¥¼ ì²˜ë¦¬

  * ë˜í•œ ë‹¤í–‰íˆ ì²« ë²ˆì§¸ ì¼€ì´ìŠ¤ëŠ” ì •ê·œì‹œì¦Œ ë°ì´í„°ë¥¼ í†µí•´ 1, 2, 3ë…„ ì „ì˜ ì„±ì  ì—­ì‹œ êµ¬í•  ìˆ˜ ìˆìŒ.

    >  ì¼ë³„ ë°ì´í„° ì¶œë£¨ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for batter_name in ["ê¹€ì£¼ì°¬", "ì´ë²”í˜¸"]:
         # 30íƒ€ìˆ˜ ì´ìƒì¸ í•´ë‹¹ì„ ìˆ˜ì˜ ì¸ë±ìŠ¤(Boolean)
        cond_regular = (regular_season_df['AB'] >= 30) & \
                       (regular_season_df['batter_name'] == batter_name)
        
        # íƒ€ìˆ˜ë¥¼ ê³ ë ¤í•´ í‰ê·  OBP ê³„ì‚°
        mean_OBP = sum(regular_season_df.loc[cond_regular,'AB'] * \
                       regular_season_df.loc[cond_regular,'OBP']) / \
                   sum(regular_season_df.loc[cond_regular,'AB'])
        
        submission_OBP.loc[(submission_OBP['batter_name'] == batter_name),'mean_OBP'] = \
            mean_OBP
        
        # regular_season_Batterìœ¼ë¡œë¶€í„° 1, 2, 3ë…„ ì „ ì„±ì  êµ¬í•˜ê¸°
        cond_sub = submission_OBP['batter_name'] == batter_name
        submission_OBP.loc[cond_sub,'lag1_OBP'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year']==2018),'OBP'].values
        submission_OBP.loc[cond_sub,'lag2_OBP'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year']==2017),'OBP'].values
        submission_OBP.loc[cond_sub,'lag3_OBP'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year']==2016),'OBP'].values
    ```

* case2

  * ë‘ ë²ˆì§¸ ì¼€ì´ìŠ¤ëŠ” 1998ë…„ í˜¹ì€ 1999ë…„ ì¶œìƒì˜ ì‹ ì¸ê¸‰ ì„ ìˆ˜

  * ì´ ì‚¬ë¡€ì— í•´ë‹¹í•˜ëŠ” ì„  ìˆ˜ëŠ” ê³ ëª…ì„±, ì „ë¯¼ì¬, ê¹€ì² í˜¸, ì‹ ë²”ìˆ˜, ì´ë³‘íœ˜

  * ì•ì„œ ë‚˜ì´ì— ë”°ë¥¸ OPSì„±ì  ë³€í™”ë¥¼ ì‚´í´ë´¤ì„ ë•Œ ë‚˜ì´ê°€ ì–´ë¦° ê²½ìš° ì´í›„ ì„±ì ì´ ë” ë†’ì•„ì§€ëŠ” ê²½í–¥ì´ ìˆìŒ

  * ë‘ ë²ˆì§¸ ì¼€ì´ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ì„ ìˆ˜ë“¤ì€ ì„±ì¥ ê°€ëŠ¥ì„±ì´ ìˆì–´ í‰ê·  ì´ìƒì„ ê¸°ëŒ€í•  ìˆ˜ ìˆëŠ” ì„ ìˆ˜ë¡œ íŒë‹¨í•˜ê³  2018 ì‹œì¦Œì˜ ì„±ì ìœ¼ë¡œ ì¶œë£¨ìœ¨ì˜ í‰ê· ì„ ëŒ€ì²´

    >  ì‹ ì¸ ì„ ìˆ˜ì˜ ì¶œë£¨ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for i in np.where(submission_OBP['batter_name'].isin(["ê³ ëª…ì„±","ì „ë¯¼ì¬","ê¹€ì² í˜¸","ì‹ ë²”ìˆ˜","ì´ë³‘íœ˜"])):
        #submission_OBP.loc[i,'mean_OBP'] = season_OBP_mean.loc[season_OBP_mean['year']==2018,'mean_OBP'].values
        submission_OBP.loc[i,'mean_OBP'] = \
            season_OBP_mean.loc[season_OBP_mean['year']==2018,'mean_OBP']
    ```

* case3

  * ì„¸ ë²ˆì§¸ ì¼€ì´ìŠ¤ëŠ” 2018ë…„ í•˜ë°˜ê¸°ì˜ ì„±ì ë§Œ ìˆëŠ” ê²½ìš°

  * ì´ì— í•´ë‹¹í•˜ëŠ” ì„ ìˆ˜ëŠ” ìƒŒì¦ˆ, ì „ë³‘ìš° 

  * í•´ë‹¹ ì„ ìˆ˜ë“¤ì€ ì •ê·œì‹œì¦Œ ì„±ì ì„ ë°”íƒ•ìœ¼ë¡œ í‰ê·  ì¶œë£¨ìœ¨ ë° 1ë…„ ì „ ì¶œë£¨ìœ¨ ìˆ˜ì¹˜ë¥¼ ëŒ€ì²´

    > ìƒë°˜ê¸° ì¶œë£¨ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for batter_name in ["ì „ë³‘ìš°","ìƒŒì¦ˆ"]:
        # 30 íƒ€ìˆ˜ ì´ìƒì¸ í•´ë‹¹ ì„ ìˆ˜ì˜ index ì¶”ì¶œ
        cond_regular = (regular_season_df['AB']>=30) & \
                       (regular_season_df['batter_name']==batter_name) 
    
    # íƒ€ìˆ˜ë¥¼ ê³ ë ¤í•´ ì„ ìˆ˜ì˜ í‰ê·  OBPê³„ì‚°
    mean_OBP = sum(regular_season_df.loc[cond_regular,'AB'] * \
                   regular_season_df.loc[cond_regular,'OBP']) / \
               sum(regular_season_df.loc[cond_regular,'AB'])
        
    submission_OBP.loc[(submission_OBP['batter_name'] == batter_name),'mean_OBP'] = mean_OBP
    
    cond_sub = submission_OBP['batter_name'] == batter_name
    
    # 2018ë…„ ë°ì´í„°ë¡œë¶€í„° 2019ë…„ì˜ 1ë…„ ì „ ì„±ì  ê¸°ì…
    submission_OBP.loc[cond_sub,'lag1_OBP'] = regular_season_df.loc[
        (cond_regular)&(regular_season_df['year']==2018),'OBP'].values
    ```

* case4

  * ë§ˆì§€ë§‰ ì¼€ì´ìŠ¤ëŠ” ì€í‡´ë¥¼ í–ˆê±°ë‚˜ 1êµ° ìˆ˜ì¤€ì˜ ì„±ì ì„ ë³´ì—¬ì£¼ì§€ ëª»í•˜ëŠ” ì„ ìˆ˜

  * ì´ ì„ ìˆ˜ ë“¤ì˜ ì„±ì ì€ í•˜ìœ„ 25%ì˜ ì„±ì ìœ¼ë¡œ ëŒ€ì²´í•´ì„œ ê°’ì„ ë„£ìŒ

    > í‰ê·  ì¶œë£¨ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    # í‰ê·  ì„±ì ì´ ê²°ì¸¡ì¹˜ì¸ ì„ ìˆ˜ë“¤ì— ëŒ€í•´ í‰ê·  OBPì˜ í•˜ìœ„ 25% ì„±ì  ê¸°ì…
    submission_OBP.loc[submission_OBP['mean_OBP'].isna(),'mean_OBP'] = \
        np.quantile(player_OBP_mean['mean_OBP'],0.25)
    ```

* ì§€ê¸ˆê¹Œì§€ í‰ê·  ì¶œë£¨ìœ¨ ì„±ì ì— ëŒ€í•´ ëª¨ë‘ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ ì™„ë£Œí•¨

* ì´ì œ ì•ì„œ ìƒì„±í•œ ê²°ì¸¡ ì¹˜ ì²˜ë¦¬ í•¨ìˆ˜ì¸ `lag_na_fill`ì„ ì´ìš©í•´ í‰ê·  ì„±ì ì´ ì•„ë‹Œ 1, 2, 3ë…„ ì „ ì„±ì ì˜ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ ì§„í–‰

  > 3ë…„ ì „ê¹Œì§€ì˜ í‰ê·  ì¶œë£¨ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

  ```python
  for i in [1,2,3]: 
      # ië…„ ì „ OBP ê²°ì¸¡ì¹˜ ì œê±°
      submission_OBP = lag_na_fill(submission_OBP, 'OBP', i, season_OBP_mean)
  submission_OBP.head()
  ```

  


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>year</th>
        <th>year_born</th>
        <th>age</th>
        <th>mean_OBP</th>
        <th>lag1_OBP</th>
        <th>lag2_OBP</th>
        <th>lag3_OBP</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>2019</td>
        <td>1992ë…„ 08ì›” 11ì¼</td>
        <td>27</td>
        <td>0.337880</td>
        <td>0.423611</td>
        <td>0.285714</td>
        <td>0.222222</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>2019</td>
        <td>1993ë…„ 06ì›” 09ì¼</td>
        <td>26</td>
        <td>0.304124</td>
        <td>0.329991</td>
        <td>0.330297</td>
        <td>0.336224</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>2019</td>
        <td>1992ë…„ 01ì›” 10ì¼</td>
        <td>27</td>
        <td>0.304124</td>
        <td>0.329991</td>
        <td>0.330297</td>
        <td>0.336224</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>2019</td>
        <td>1985ë…„ 08ì›” 18ì¼</td>
        <td>34</td>
        <td>0.358187</td>
        <td>0.328990</td>
        <td>0.386076</td>
        <td>0.441860</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>2019</td>
        <td>1999ë…„ 07ì›” 29ì¼</td>
        <td>20</td>
        <td>0.356164</td>
        <td>0.355685</td>
        <td>0.356317</td>
        <td>0.362245</td>
      </tr>
    </tbody>
  </table>

  </div>

#### SLG

* ê³¼ê±° ì¥íƒ€ìœ¨ì„ ìƒì„±

  ```python
  # ì•ì„œ ì „ì²˜ë¦¬í•œ ë°ì´í„°ë¡œ í‰ê·  SLG ê°’ ê¸°ì…
  submission_SLG = submission_SLG.merge(
      sum_hf_yr_SLG[['batter_name','mean_SLG']].drop_duplicates().reset_index(drop=True),
      how='left', on='batter_name')
  
  # ì•ì„œ ì „ì²˜ë¦¬í•œ ë°ì´í„°ì—ì„œ ê³¼ê±° SLG ê°’ ì±„ìš°ê¸°
  for i in [1,2,3]:
      temp_lag_df = sum_hf_yr_SLG.loc[(sum_hf_yr_SLG['year'] == (2019 - i)) &
          (sum_hf_yr_SLG['AB']>=30),['batter_name','SLG']].copy()
      
      temp_lag_df.rename(columns={'SLG':'lag'+str(i)+'_SLG'}, inplace=True)
      
      submission_SLG = submission_SLG.merge(temp_lag_df, how='left', on='batter_name')
  ```

* ê²°ì¸¡ì¹˜ ì¡´ê°œ ì„ ìˆ˜ ëª…ë‹¨ í™•ì¸

  > ì¥íƒ€ìœ¨ì— ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ì„ ìˆ˜

  ```python
  submission_SLG['batter_name'].loc[submission_SLG['mean_SLG'].isna()].values
  
  ```


      array(['ê°•êµ¬ì„±', 'ê°•ë¯¼êµ­', 'ê°•ìƒì›', 'ê³ ëª…ì„±', 'ê¹€ì‘ë¯¼', 'ê¹€ì¢…ë•', 'ê¹€ì£¼ì°¬', 'ê¹€ì² í˜¸', 'ê¹€íƒœì—°',
             'ê¹€íƒœì§„', 'ê¹€í˜•ì¤€', 'ë‚˜ì›íƒ', 'ë‚¨íƒœí˜', 'ë°•ê´‘ì—´', 'ë°•ê¸°í˜', 'ë°±ë¯¼ê¸°', 'ìƒŒì¦ˆ', 'ì‹ ë²”ìˆ˜',
             'ì‹ ì„±í˜„', 'ì–‘ì¢…ë¯¼', 'ìœ¤ì •ìš°', 'ì´ë™í›ˆ', 'ì´ë²”í˜¸', 'ì´ë³‘íœ˜', 'ì´ì„±ê³¤', 'ì´ì¸í–‰', 'ì´ì¢…ìš±',
             'ì´ì§„ì˜', 'ì´ì°½ì§„', 'ì¥ìŠ¹í˜„', 'ì¥ì‹œìœ¤', 'ì „ë¯¼ì¬', 'ì „ë³‘ìš°', 'ì •ê²½ìš´', 'ì •ì„±í›ˆ', 'ì¡°í™ì„',
             'ìµœì›ì œ', 'í™ì°½ê¸°'], dtype=object)

* ì¥íƒ€ìœ¨ì— ê²°ì¦‰ì¹˜ê°€ ìˆëŠ” ì„ ìˆ˜ ëª…ë‹¨ì€ ì¶œë£¨ìœ¨ì— ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ì„ ìˆ˜ ëª…ë‹¨ê³¼ ë™ì¼í•œ ê²ƒì„ í™•ì¸ ê°€ëŠ¥

* ì¶œë£¨ìœ¨ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ 4ê°€ì§€ ì¼€ì´ìŠ¤ë¡œ ë¶„ë¥˜í•´ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ ì§„í–‰

* case1

  * ì²« ë²ˆì§¸ ì¼€ì´ìŠ¤ì¸ ì •ê·œì‹œì¦Œ ë°ì´í„°ì—ëŠ” ê¸°ë¡ì´ ìˆì§€ë§Œ ì¼ë³„ ë°ì´í„°ì—ëŠ” ê¸°ë¡ì´ ì—†ëŠ” ì„ ìˆ˜ë“¤ ì— ëŒ€í•œ ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    > ì¼ë³„ ë°ì´í„° ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for batter_name in ["ê¹€ì£¼ì°¬", "ì´ë²”í˜¸"]:
         # mean_SLG ê³„ì‚°
        cond_regular = (regular_season_df['AB'] >= 30) & \
                       (regular_season_df['batter_name'] == batter_name)
        
        # íƒ€ìˆ˜ë¥¼ ê³ ë ¤í•´ ì„ ìˆ˜ì˜ í‰ê·  SLG ê³„ì‚°
        mean_SLG = sum(regular_season_df.loc[cond_regular,'AB'] * \
                       regular_season_df.loc[cond_regular,'SLG']) / \
                   sum(regular_season_df.loc[cond_regular,'AB'])
        
        submission_SLG.loc[(submission_SLG['batter_name'] == batter_name), 'mean_SLG'] = \
            mean_SLG
        
        # regular_season_Batterìœ¼ë¡œë¶€í„° 1, 2, 3ë…„ ì „ ì„±ì  êµ¬í•˜ê¸°
        cond_sub = submission_SLG['batter_name'] == batter_name
        
        submission_SLG.loc[cond_sub,'lag1_SLG'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year'] == 2018),'SLG'].values
        submission_SLG.loc[cond_sub,'lag2_SLG'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year'] == 2017),'SLG'].values
        submission_SLG.loc[cond_sub,'lag3_SLG'] = regular_season_df.loc[
            (cond_regular) & (regular_season_df['year'] == 2016),'SLG'].values
    ```

* case2

  * ë‘ ë²ˆì§¸ ì¼€ì´ìŠ¤ì¸ 1998ë…„ í˜¹ì€ 1999ë…„ ì¶œìƒì¸ ì‹ ì¸ ì„ ìˆ˜ë“¤ì— ëŒ€í•œ ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    > ì‹ ì¸ ì„ ìˆ˜ì˜ ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for i in np.where(submission_SLG['batter_name'].isin(
        ["ê³ ëª…ì„±","ì „ë¯¼ì¬","ê¹€ì² í˜¸","ì‹ ë²”ìˆ˜","ì´ë³‘íœ˜"])):
         # ìœ„ì˜ í•´ë‹¹ ì„ ìˆ˜ë“¤ì˜ í‰ê·  SLG í‰ê· ê°’ìœ¼ë¡œ ëŒ€ì²´
        #submission_SLG.loc[i,'mean_SLG'] = season_SLG_mean.loc[season_SLG_mean['year']==2018,'mean_SLG'].values
        submission_SLG.loc[i,'mean_SLG'] = \
            season_SLG_mean.loc[season_SLG_mean['year']==2018,'mean_SLG']
    ```

* case3

  * ì„¸ ë²ˆì§¸ ì¼€ì´ìŠ¤ì¸ ìƒë°˜ê¸° ê¸°ê°„ì˜ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì„ ìˆ˜ë“¤ì— ëŒ€í•œ ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    > ìƒë°˜ê¸° ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    for batter_name in ["ì „ë³‘ìš°","ìƒŒì¦ˆ"]:
        
        # 30íƒ€ìˆ˜ ì´ìƒì¸ í•´ë‹¹ì„ ìˆ˜ì˜ ì¸ë±ìŠ¤(Boolean) 
        cond_regular = (regular_season_df['AB']>=30)&\
    (regular_season_df['batter_name']==batter_name)
    
    # íƒ€ìˆ˜ë¥¼ ê³ ë ¤í•œ í‰ê·  SLG ê³„ì‚°
    mean_SLG = sum(regular_season_df.loc[cond_regular,'AB']*
    regular_season_df.loc[cond_regular,'SLG']) / sum(regular_season_df.loc[cond_regular,'AB'])
    
    # í•´ë‹¹ ì„ ìˆ˜ì˜ í‰ê·  SLG ê°’ ê¸°ì…
    submission_SLG.loc[(submission_SLG['batter_name'] == batter_name),
    'mean_SLG'] = mean_SLG
    
    # í•´ë‹¹ ì„ ìˆ˜ì˜ 1ë…„ ì „ SLGê°’ ê¸°ì…
    cond_sub = submission_SLG['batter_name'] == batter_name
    submission_SLG.loc[cond_sub,'lag1_SLG'] = regular_season_df.loc[(cond_regular)&
    (regular_season_df['year']==2018),'SLG'].values
    ```

* case4

  * ë„¤ ë²ˆì§¸ ì¼€ì´ìŠ¤ëŠ” ì€í‡´ë¥¼ í–ˆê±°ë‚˜ 1êµ° ìˆ˜ì¤€ì˜ ì„±ì ì„ ë³´ì—¬ì£¼ì§€ ëª»í•˜ëŠ” ì„ ìˆ˜ë“¤ ëŒ€í•œ ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    > í‰ê·  ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

    ```python
    # í‰ê·  ì„±ì ì´ ê²°ì¸¡ì¹˜ì¸ ì„ ìˆ˜ë“¤ì— ëŒ€í•´ í‰ê·  SLGì˜ í•˜ìœ„ 25% ì„±ì  ê¸°ì…
    submission_SLG.loc[submission_SLG['mean_SLG'].isna(),'mean_SLG'] = \
        np.quantile(player_SLG_mean['mean_SLG'],0.25)
    ```

* í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ì— ëŒ€í•´ì„œë„ í‰ê·  ì¥íƒ€ìœ¨ì— ëŒ€í•œ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ ì™„ë£Œ

* ì¶œë£¨ìœ¨ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í‰ê·  ì¥íƒ€ìœ¨ì„ ê¸°ë°˜ìœ¼ë¡œ 1, 2, 3ë…„ ì „ ì¥íƒ€ìœ¨ì„ ì¶”ê°€

  > 3ë…„ ì „ê¹Œì§€ì˜ í‰ê·  ì¥íƒ€ìœ¨ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

  ```python
  for i in [1,2,3]:
      # ië…„ ì „ SLG ì„±ì  ê²°ì¸¡ì¹˜ ì²˜ë¦¬
      submission_SLG = lag_na_fill(submission_SLG, 'SLG', i, season_SLG_mean)
  submission_SLG.head()
  ```


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>year</th>
        <th>year_born</th>
        <th>age</th>
        <th>mean_SLG</th>
        <th>lag1_SLG</th>
        <th>lag2_SLG</th>
        <th>lag3_SLG</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>2019</td>
        <td>1992ë…„ 08ì›” 11ì¼</td>
        <td>27</td>
        <td>0.332527</td>
        <td>0.523810</td>
        <td>0.256098</td>
        <td>0.222222</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>2019</td>
        <td>1993ë…„ 06ì›” 09ì¼</td>
        <td>26</td>
        <td>0.326923</td>
        <td>0.391429</td>
        <td>0.385754</td>
        <td>0.385397</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>2019</td>
        <td>1992ë…„ 01ì›” 10ì¼</td>
        <td>27</td>
        <td>0.326923</td>
        <td>0.391429</td>
        <td>0.385754</td>
        <td>0.385397</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>2019</td>
        <td>1985ë…„ 08ì›” 18ì¼</td>
        <td>34</td>
        <td>0.466540</td>
        <td>0.487273</td>
        <td>0.548736</td>
        <td>0.577689</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>2019</td>
        <td>1999ë…„ 07ì›” 29ì¼</td>
        <td>20</td>
        <td>0.523719</td>
        <td>0.532051</td>
        <td>0.484152</td>
        <td>0.483795</td>
      </tr>
    </tbody>
  </table>

  </div>

* ì´ì œ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ì— ëŒ€í•´ì„œë„ ì „ì²˜ë¦¬ ë° ë³€ìˆ˜ ìƒì„± ì‘ì—…ì´ ì™„ë£Œë¨

* ì§€ê¸ˆë¶€í„° ìµœì¢… 2019ë…„ KBO ìƒë°˜ê¸° íƒ€ì OPS ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë„ì¶œ

* ì•Œê³ ë¦¬ì¦˜ë³„ ì„±ëŠ¥ ë¹„êµì—ì„œ OBPë¥¼ ì˜ˆì¸¡í•  ë•ŒëŠ” ëœë¤ í¬ë ˆìŠ¤íŠ¸ê°€ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì˜€ê³  SLGë¥¼ ì˜ˆì¸¡í•  ë•ŒëŠ” ë¼ì˜ íšŒê·€ ëª¨ë¸ì´ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì„

* ë”°ë¼ì„œ OBPì™€ SLG ì—ì„œ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì¸ ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´ ì˜ˆì¸¡ê°’ì„ ìƒì„±

  > OBPì™€ SLG ì˜ˆì¸¡ê°’ ìƒì„±

  ```python
  # Random Forestsë¥¼ ì´ìš©í•´ OBP ì˜ˆì¸¡
  predict_OBP = OBP_RF_models['RF'].predict(submission_OBP.iloc[:,-5:]) 
  # Lassoë¥¼ ì´ìš©í•´ SLG ì˜ˆì¸¡
  predict_SLG = SLG_linear_models ['Lasso'].predict(submission_SLG.iloc[:,-5:])
  ```

* ê²½ì§„ëŒ€íšŒ ì–‘ì‹ì— ë§ëŠ” ìµœì¢… íŒŒì¼ì„ ì œì¶œí•˜ê¸° ìœ„í•´ submission ë°ì´í„°ì…‹ì—ì„œ `batter_id`ì™€ `batter_name`ì„ ê°€ì ¸ì™€ final_submissionì— ì €ì¥

* ì˜ˆì¸¡ëœ OBPì™€ SLG ê°’ì„ ë”í•´ íƒ€ ìì˜ 2019ë…„ 0PSë¥¼ ì˜ˆì¸¡

* ì´ë¡œì¨ ìµœì¢… ì œì¶œì„ ìœ„í•œ ë°ì´í„°ì…‹ì´ ì™„ì„±

  > OPS ì˜ˆì¸¡

  ```python
  final_submission = submission[['batter_id','batter_name']]
  final_submission['OPS'] = predict_SLG + predict_OBP # OBP + SLG = OPS 
  final_submission.head(10)
  ```

      C:\Users\kimminsung\AppData\Roaming\Python\Python36\site-packages\ipykernel_launcher.py:2: SettingWithCopyWarning: 
      A value is trying to be set on a copy of a slice from a DataFrame.
      Try using .loc[row_indexer,col_indexer] = value instead
      
      See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy


  â€‹    

  


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>OPS</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>0.503957</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>0.687933</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>0.696609</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>0.958395</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>0.751592</td>
      </tr>
      <tr>
        <th>5</th>
        <td>8</td>
        <td>ê°•ìƒì›</td>
        <td>0.661807</td>
      </tr>
      <tr>
        <th>6</th>
        <td>9</td>
        <td>ê°•ìŠ¹í˜¸</td>
        <td>0.505642</td>
      </tr>
      <tr>
        <th>7</th>
        <td>11</td>
        <td>ê°•ì§„ì„±</td>
        <td>0.656007</td>
      </tr>
      <tr>
        <th>8</th>
        <td>12</td>
        <td>ê°•í•œìš¸</td>
        <td>0.672859</td>
      </tr>
      <tr>
        <th>9</th>
        <td>16</td>
        <td>ê³ ëª…ì„±</td>
        <td>0.640507</td>
      </tr>
    </tbody>
  </table>

  </div>

### 5_4 ë°˜ë°œê³„ìˆ˜ì˜ ë³€í™”

* ì•ì„œ ëŒ€íšŒë¥¼ ìœ„í•œ ìµœì¢… ì œì¶œ íŒŒì¼ì„ ì™„ì„±

  * ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ 2019ë…„ì˜ íŠ¹ì§•ì„±ì„ ë°˜ì˜í•´ ìµœì¢… ëª¨ë¸ë§ì„ ì™„ë£Œ
  * 2019ë…„ì´ë¼ëŠ” ì‹œì¦Œì˜ íŠ¹ì§•ì„ ì‚´í´ë³´ë©´ 2019ë…„ ìƒë°˜ê¸° KBO íƒ€ìì˜ ì„±ì ì„ ë” ì •í™•íˆ ì˜ˆì¸¡ ê°€ëŠ¥
  * ê·¸ëŸ¬í•œ ë©´ì—ì„œ ìƒê°í–ˆì„ ë•Œ, 2019 ì‹œì¦Œì— íƒ€ìë“¤ì—ê²Œ ê°€ì¥ í° ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ë³€í™”ëŠ” ë°”ë¡œ ê³µì¸êµ¬ì˜ ë°˜ë°œê³„ìˆ˜ ë³€í™”
  * ë°˜ë°œê³„ìˆ˜ë€ ë¬¼ì²´ê°€ ì¶©ëŒí–ˆì„ ë•Œ ì¶©ëŒ ì „í›„ ì†ë„ì˜ ë¹„ë¥¼ ì˜ë¯¸
  * ì•¼êµ¬ì—ì„œ ê³µì¸êµ¬ì˜ ë°˜ë°œê³„ìˆ˜ê°€ ë‹¬ë¼ì§„ë‹¤ë©´ ì•¼êµ¬ ë°°íŠ¸ì™€ ì•¼êµ¬ê³µì˜ ì¶©ëŒ ì „í›„ ì•¼êµ¬ê³µ ì†ë„ì˜ ë¹„ê°€ ë‹¬ë¼ì§
  * ì¶©ëŒ í›„ì˜ ì†ë„ê°€ ì „ê³¼ ë‹¬ë¼ì§„ë‹¤ë©´ ì•¼êµ¬ê³µì´ ë‚ ì•„ê°€ëŠ” ê±°ë¦¬ì—ë„ ì˜í–¥ì„ ë¯¸ì¹¨
  * 2019 ì‹œì¦Œì— KBOëŠ” ìƒˆë¡­ê²Œ ë°˜ë°œê³„ìˆ˜ë¥¼ ë‚®ì¶˜ ì•¼êµ¬ê³µì„ ì´ìš© 

* ê³µì¸êµ¬ì˜ ë°˜ë°œê³„ìˆ˜ ë³€í™”ëŠ” íƒ€ìë“¤ì˜ ì„±ì ì— ìœ ì˜ë¯¸í•˜ê²Œ ì˜í–¥ì„ ì¤Œ

  * ë°˜ë°œê³„ìˆ˜ë¥¼ ë‚®ì¶˜ ì•¼êµ¬ê³µì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì€ ì „ê³¼ ë™ì¼í•œ í˜ìœ¼ë¡œ ê³µì„ ì³¤ì„ ë•Œ ê³µì´ ì´ì „ ê³µ(ë°˜ë°œê³„ìˆ˜ ë¥¼ ë‚®ì¶”ê¸° ì „ì˜ ê³µ)ë³´ë‹¤ ë” ì¡°ê¸ˆ ë‚ ì•„ê°„ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ê¸° ë•Œë¬¸
  * ì„ ìˆ˜ì˜ ì—­ëŸ‰ì´ ê°™ë”ë¼ë„ ì–´ëŠ ì •ë„ì˜ ì„±ì  í•˜ë½ í˜„ìƒì´ ë°œìƒ ê°€ëŠ¥
  * ì´ë¥¼ íƒ€ë‹¹í•˜ê²Œ ë°˜ì˜í•˜ê¸° ìœ„í•´ ê³¼ê±° ì¼ë³¸ ì‚¬ë¡€ë¥¼ ì°¸ê³ 
  * ê³µì¸êµ¬ ë°˜ë°œê³„ìˆ˜ë¥¼ ë˜‘ê°™ì´ ì¡°ì •í•œ ì ì´ ìˆëŠ” ì¼ë³¸ ì‚¬ë¡€ì—ì„œëŠ” í™ˆëŸ°ì´ ì´ì „ ì‹œì¦Œë³´ë‹¤ ì•½ ì ˆë°˜ìœ¼ë¡œ ì¤„ì–´ë“¦
  * í™ˆëŸ° ê°œìˆ˜ë¼ëŠ” ë°˜ë°œê³„ìˆ˜ ë³€í™” íš¨ê³¼ì— ëŒ€í•œ ë‹¨ì„œê°€ ìƒê²¼ìœ¼ë¯€ë¡œ ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê³µì¸êµ¬ ë³€í™”ì˜ íš¨ê³¼ë¥¼ ì˜ˆì¸¡

  > í™ˆëŸ° ìˆ˜ ë³‘í•©

  ```python
  # ì‹œì¦Œë³„ ì „ì²´ OBP ê³„ì‚°(30íƒ€ìˆ˜ ì´ìƒì¸ ì„ ìˆ˜ë“¤ì˜ ê¸°ë¡ë§Œ ì´ìš©)
  season_OBP = \
      regular_season_df.loc[regular_season_df['AB'] >= 30].groupby('year').agg(
          {'AB':'sum', 'H':'sum', 'BB':'sum', 'HBP':'sum', 'SF':'sum'}).reset_index()
  
  season_OBP['OBP'] = season_OBP[['H','BB','HBP']].sum(axis=1) / \
                      season_OBP[['AB','BB','HBP','SF']].sum(axis=1)
  
  # ì‹œì¦Œë³„ ì „ì²´ SLG ê³„ì‚°(30íƒ€ìˆ˜ ì´ìƒì¸ ì„ ìˆ˜ë“¤ì˜ ê¸°ë¡ë§Œ ì´ìš©)
  season_SLG = \
      regular_season_df.loc[regular_season_df['AB']>=30].groupby('year').agg(
          {'AB':'sum', 'H':'sum', '2B':'sum', '3B':'sum', 'HR':'sum'}).reset_index()
  
  season_SLG['SLG'] = ((season_SLG['H'] - season_SLG[['2B','3B','HR']].sum(axis=1)) + \
                       season_SLG['2B']*2+season_SLG['3B']*3+ season_SLG['HR']*4) / \
                      season_SLG['AB']
  
  # season_OBPì™€ season_SLGë¥¼ ë³‘í•© í›„ season_OPSë¥¼ ìƒì„±í•´ OPS ê³„ì‚°
  season_OPS = pd.merge(season_OBP[['year','OBP']],season_SLG[['year', 'SLG']], on = 'year')
  season_OPS['OPS'] = season_OPS['OBP'] + season_OPS['SLG']
  
  # ì‹œì¦Œë³„ ì „ì²´ í™ˆëŸ° ìˆ˜ì™€ í•œ ì„ ìˆ˜ë‹¹ í‰ê·  í™ˆëŸ° ìˆ˜ ê³„ì‚°
  season_HR = regular_season_df.loc[regular_season_df['AB']>=30].groupby('year').agg(
      {'HR':['sum','mean','count']}).reset_index()
  season_HR.columns = ['year', 'sum_HR', 'mean_HR', 'count']
  
  # ê¸°ì¡´ì˜ OPS ë°ì´í„°ì…‹ê³¼ ë³‘í•©
  season_OPS = season_OPS.merge(season_HR,on ='year' ,how='left')
  display(season_OPS.tail())
  ```


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>year</th>
        <th>OBP</th>
        <th>SLG</th>
        <th>OPS</th>
        <th>sum_HR</th>
        <th>mean_HR</th>
        <th>count</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>21</th>
        <td>2014</td>
        <td>0.368970</td>
        <td>0.446302</td>
        <td>0.815272</td>
        <td>1013</td>
        <td>7.235714</td>
        <td>140</td>
      </tr>
      <tr>
        <th>22</th>
        <td>2015</td>
        <td>0.362742</td>
        <td>0.434129</td>
        <td>0.796871</td>
        <td>1222</td>
        <td>7.685535</td>
        <td>159</td>
      </tr>
      <tr>
        <th>23</th>
        <td>2016</td>
        <td>0.368325</td>
        <td>0.443871</td>
        <td>0.812196</td>
        <td>1267</td>
        <td>7.918750</td>
        <td>160</td>
      </tr>
      <tr>
        <th>24</th>
        <td>2017</td>
        <td>0.356469</td>
        <td>0.444584</td>
        <td>0.801053</td>
        <td>1450</td>
        <td>8.285714</td>
        <td>175</td>
      </tr>
      <tr>
        <th>25</th>
        <td>2018</td>
        <td>0.355858</td>
        <td>0.455936</td>
        <td>0.811794</td>
        <td>1726</td>
        <td>9.806818</td>
        <td>176</td>
      </tr>
    </tbody>
  </table>

  </div>

* 2018 ì‹œì¦Œì— 30íƒ€ìˆ˜ ì´ìƒì„ ê¸°ë¡í•œ ì„ ìˆ˜ì˜ í™ˆëŸ°ì€ ì´ 1,726ê°œ

* 1.762/2=863ì´ë¯€ë¡œ 863ê°œì˜ í™ˆëŸ°ì´ ì¤„ì–´ë“¤ì—ˆì„ ë•Œ OPSê°€ ì–¼ë§ˆë‚˜ ê°ì†Œí•˜ëŠ”ì§€ë¥¼ ë´„

* ë‹¤ë§Œ, í™ˆëŸ°ì´ ë  íƒ€êµ¬ê°€ í™ˆëŸ°ì´ ë˜ì§€ ì•Šë”ë¼ë„ ì•ˆíƒ€ê°€ ë˜ì–´ OPS í•˜ë½ì—ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì„ ê°€ëŠ¥ ì„±ë„ ìˆìŒ.

* ë”°ë¼ì„œ ì•ˆíƒ€ì™€ ì•„ì›ƒ ë‘ ê°€ì§€ì˜ ê²½ìš°ë¡œ ë‚˜ëˆ„ì–´ 863/2=431.5ë¼ëŠ” í™ˆëŸ° ê°œìˆ˜ê°€ ì‹¤ì œ OPS í•˜ë½ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤ê³  ê°€ì •

* 431.5ê°œì˜ í™ˆëŸ° ê°œìˆ˜ë¥¼ 2018ì‹œì¦Œ 30íƒ€ìˆ˜ ì´ìƒì„ ê¸°ë¡í•œ íƒ€ìì˜ ìˆ˜ë¡œ ë‚˜ëˆ„ë©´ 431.5/176= 2.45ì…ë‹ˆë‹¤. ì¦‰ í™ˆëŸ° ê°œìˆ˜ê°€ í‰ê· ì ìœ¼ë¡œ 2.45ê°œ ì ì€ ì‹œì¦Œì˜ OPS ìˆ˜ì¹˜ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìŒ

  > 2018ë…„ í‰ê·  í™ˆëŸ° ê°œìˆ˜ì™€ ì‹œì¦Œë³„ í‰ê·  í™ˆëŸ° ìˆ˜ì˜ ì°¨ì´

  ```python
  #2018ë…„ì˜ í‰ê·  í™ˆëŸ° ê°œìˆ˜ë¥¼ ì‹œì¦Œë³„ í‰ê·  í™ˆëŸ° ìˆ˜ì—ì„œ ëº€ë‹¤(HR_diff)
  season_OPS['HR_diff'] = season_OPS['mean_HR'] - season_OPS['mean_HR'].iloc[-1]
  difference = season_OPS.sort_values(by = 'HR_diff')[['year','OPS','HR_diff']]
  display(difference.reset_index(drop=True).head(12))
  ```


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>year</th>
        <th>OPS</th>
        <th>HR_diff</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>2012</td>
        <td>0.703301</td>
        <td>-5.799242</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2013</td>
        <td>0.748820</td>
        <td>-4.891325</td>
      </tr>
      <tr>
        <th>2</th>
        <td>2006</td>
        <td>0.709301</td>
        <td>-4.806818</td>
      </tr>
      <tr>
        <th>3</th>
        <td>2008</td>
        <td>0.741542</td>
        <td>-4.671987</td>
      </tr>
      <tr>
        <th>4</th>
        <td>2011</td>
        <td>0.735087</td>
        <td>-4.564883</td>
      </tr>
      <tr>
        <th>5</th>
        <td>2007</td>
        <td>0.730715</td>
        <td>-4.451555</td>
      </tr>
      <tr>
        <th>6</th>
        <td>2005</td>
        <td>0.740615</td>
        <td>-3.543660</td>
      </tr>
      <tr>
        <th>7</th>
        <td>2010</td>
        <td>0.770265</td>
        <td>-2.623332</td>
      </tr>
      <tr>
        <th>8</th>
        <td>2014</td>
        <td>0.815272</td>
        <td>-2.571104</td>
      </tr>
      <tr>
        <th>9</th>
        <td>2004</td>
        <td>0.751737</td>
        <td>-2.500696</td>
      </tr>
      <tr>
        <th>10</th>
        <td>2001</td>
        <td>0.821178</td>
        <td>-2.152972</td>
      </tr>
      <tr>
        <th>11</th>
        <td>2015</td>
        <td>0.796871</td>
        <td>-2.121284</td>
      </tr>
    </tbody>
  </table>

  </div>

* 2018 ì‹œì¦Œê³¼ì˜ í™ˆëŸ° ê°œìˆ˜ ì°¨ì´ë¥¼ ì˜ë¯¸í•˜ëŠ” `HR_diff` ê°’ì´ -2.45ì™€ ê°€ì¥ ê·¼ì ‘í•œ ì—°ë„ëŠ” 2004ë…„ìœ¼ë¡œ -2.50ì´ë©° 2014ë…„ì´ -2.57ë¡œ ë‘ ë²ˆì§¸, 2010ë…„ì´ -2.62ë¡œ ì„¸ ë²ˆì§¸ë¡œ ê·¼ì ‘

* 2004ë…„ì˜ ë°ì´í„°ë¶€í„° ìì„¸íˆ ë´„

  > 2000ë…„ê¹Œì§€ì˜ ë°ì´í„° ì œì™¸

  ```python
  # 2000ë…„ë„ ì´ì „ì˜ ë°ì´í„° ìˆ˜ê°€ ì¶©ë¶„ì¹˜ ì•Šì•„ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤.
  season_OPS.loc[season_OPS['year']>2000]
  ```

  


  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>year</th>
        <th>OBP</th>
        <th>SLG</th>
        <th>OPS</th>
        <th>sum_HR</th>
        <th>mean_HR</th>
        <th>count</th>
        <th>HR_diff</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>8</th>
        <td>2001</td>
        <td>0.366585</td>
        <td>0.454593</td>
        <td>0.821178</td>
        <td>199</td>
        <td>7.653846</td>
        <td>26</td>
        <td>-2.152972</td>
      </tr>
      <tr>
        <th>9</th>
        <td>2002</td>
        <td>0.343798</td>
        <td>0.424739</td>
        <td>0.768536</td>
        <td>274</td>
        <td>8.838710</td>
        <td>31</td>
        <td>-0.968109</td>
      </tr>
      <tr>
        <th>10</th>
        <td>2003</td>
        <td>0.353936</td>
        <td>0.427291</td>
        <td>0.781227</td>
        <td>301</td>
        <td>7.717949</td>
        <td>39</td>
        <td>-2.088869</td>
      </tr>
      <tr>
        <th>11</th>
        <td>2004</td>
        <td>0.344181</td>
        <td>0.407556</td>
        <td>0.751737</td>
        <td>358</td>
        <td>7.306122</td>
        <td>49</td>
        <td>-2.500696</td>
      </tr>
      <tr>
        <th>12</th>
        <td>2005</td>
        <td>0.344851</td>
        <td>0.395764</td>
        <td>0.740615</td>
        <td>357</td>
        <td>6.263158</td>
        <td>57</td>
        <td>-3.543660</td>
      </tr>
      <tr>
        <th>13</th>
        <td>2006</td>
        <td>0.334390</td>
        <td>0.374912</td>
        <td>0.709301</td>
        <td>345</td>
        <td>5.000000</td>
        <td>69</td>
        <td>-4.806818</td>
      </tr>
      <tr>
        <th>14</th>
        <td>2007</td>
        <td>0.346222</td>
        <td>0.384493</td>
        <td>0.730715</td>
        <td>407</td>
        <td>5.355263</td>
        <td>76</td>
        <td>-4.451555</td>
      </tr>
      <tr>
        <th>15</th>
        <td>2008</td>
        <td>0.350637</td>
        <td>0.390905</td>
        <td>0.741542</td>
        <td>457</td>
        <td>5.134831</td>
        <td>89</td>
        <td>-4.671987</td>
      </tr>
      <tr>
        <th>16</th>
        <td>2009</td>
        <td>0.359326</td>
        <td>0.429237</td>
        <td>0.788563</td>
        <td>806</td>
        <td>8.141414</td>
        <td>99</td>
        <td>-1.665404</td>
      </tr>
      <tr>
        <th>17</th>
        <td>2010</td>
        <td>0.356988</td>
        <td>0.413278</td>
        <td>0.770265</td>
        <td>783</td>
        <td>7.183486</td>
        <td>109</td>
        <td>-2.623332</td>
      </tr>
      <tr>
        <th>18</th>
        <td>2011</td>
        <td>0.348382</td>
        <td>0.386705</td>
        <td>0.735087</td>
        <td>650</td>
        <td>5.241935</td>
        <td>124</td>
        <td>-4.564883</td>
      </tr>
      <tr>
        <th>19</th>
        <td>2012</td>
        <td>0.337141</td>
        <td>0.366160</td>
        <td>0.703301</td>
        <td>529</td>
        <td>4.007576</td>
        <td>132</td>
        <td>-5.799242</td>
      </tr>
      <tr>
        <th>20</th>
        <td>2013</td>
        <td>0.355484</td>
        <td>0.393335</td>
        <td>0.748820</td>
        <td>698</td>
        <td>4.915493</td>
        <td>142</td>
        <td>-4.891325</td>
      </tr>
      <tr>
        <th>21</th>
        <td>2014</td>
        <td>0.368970</td>
        <td>0.446302</td>
        <td>0.815272</td>
        <td>1013</td>
        <td>7.235714</td>
        <td>140</td>
        <td>-2.571104</td>
      </tr>
      <tr>
        <th>22</th>
        <td>2015</td>
        <td>0.362742</td>
        <td>0.434129</td>
        <td>0.796871</td>
        <td>1222</td>
        <td>7.685535</td>
        <td>159</td>
        <td>-2.121284</td>
      </tr>
      <tr>
        <th>23</th>
        <td>2016</td>
        <td>0.368325</td>
        <td>0.443871</td>
        <td>0.812196</td>
        <td>1267</td>
        <td>7.918750</td>
        <td>160</td>
        <td>-1.888068</td>
      </tr>
      <tr>
        <th>24</th>
        <td>2017</td>
        <td>0.356469</td>
        <td>0.444584</td>
        <td>0.801053</td>
        <td>1450</td>
        <td>8.285714</td>
        <td>175</td>
        <td>-1.521104</td>
      </tr>
      <tr>
        <th>25</th>
        <td>2018</td>
        <td>0.355858</td>
        <td>0.455936</td>
        <td>0.811794</td>
        <td>1726</td>
        <td>9.806818</td>
        <td>176</td>
        <td>0.000000</td>
      </tr>
    </tbody>
  </table>

  </div>

* 2004ë…„ì—ëŠ” 30íƒ€ìˆ˜ ì´ìƒì„ ê¸°ë¡í•œ íƒ€ì ìˆ˜ê°€ 49ëª…

  * ì£¼ì–´ì§„ ë°ì´í„°ì˜ 30íƒ€ìˆ˜ ì´ìƒ ê¸°ë¡ íƒ€ì ìˆ˜ê°€ 2010ë…„ë¶€í„° 100ëª… ì´ìƒìœ¼ë¡œ ì•ˆì •í™”ë˜ê³  ìˆì–´ 2004ë…„ ë°ì´í„°ëŠ” ì œì™¸

* 2014ë…„ì—ëŠ” í™ˆëŸ° ì°¨ì´ëŠ” ê·¼ì ‘í•˜ì§€ë§Œ, OPSê°€ ì „ì²´ ì‹œì¦Œ ì¤‘ ê°€ì¥ ë†’ì€ ìˆ˜ì¹˜ë¥¼ ê¸°ë¡

  * ì˜¤íˆë ¤ 2018ë…„ë³´ë‹¤ ë” ë†’ì€ OPSë¥¼ ë³´ì—¬ì£¼ê³  ìˆì–´ í™ˆëŸ° ê°ì†Œê°€ OPS í•˜ë½ì— ë¯¸ì¹˜ëŠ” ì˜ í–¥ì„ íŒë‹¨í•˜ê¸°ì—ëŠ” ë¶€ì ì ˆ

* 2010ë…„ì˜ ë°ì´í„°ëŠ” 2018ë…„ë³´ë‹¤ OPSê°€ ë‚®ìœ¼ë©° íƒ€ì ìˆ˜ë„ 100ëª… ì´ìƒì„ ê¸°ë¡

  * ë‘ ì—°ë„ë¥¼ ë¹„êµí•´ ë³¸ ê²°ê³¼ OPSëŠ” í‰ê· ì ìœ¼ë¡œ 0.041ï¼ˆ2018ë…„ì˜ OPS = 0.81, 2010ë…„ì˜ OPS = 0.77ï¼‰, í™ˆëŸ° ê°œìˆ˜ëŠ” í‰ê· ì ìœ¼ë¡œ 2.62ê°œì˜ ì°¨ì´ë¥¼ ë³´ì„
  * ì˜ˆìƒë˜ëŠ” 2018 ì‹œì¦Œ ëŒ€ë¹„ 2019 ì‹œì¦Œ í‰ê·  í™ˆëŸ° ê°œìˆ˜ ì°¨ì´ëŠ” 2.45ì´ë¯€ë¡œ ì´ ë¹„ì¤‘ì„ ì¡°ê¸ˆ ë” ì •ë°€í•˜ê²Œ ê³„ì‚°

* 2.45x0.041/2.62=0.038ë¡œ í™ˆëŸ° ê°œìˆ˜ì˜ ê°ì†Œë¡œ ì¸í•´ ì•½ 0.038ì˜ OPS í•˜ë½ì´ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ ê°€ëŠ¥

* ì´ì œ ì˜ˆì¸¡ëœ 2019 ì‹œì¦Œ ìƒë°˜ê¸° KBO íƒ€ì OPS ì„±ì ì—ì„œ ì¼ê´„ì ìœ¼ë¡œ 0.038 ìˆ˜ì¹˜ë¥¼ ë¹¼ ìƒˆë¡œìš´ ì˜ˆì¸¡ ê²°ê³¼ë¬¼ì„ ìƒì„±

  > 2019ë…„ ê³µì¸êµ¬ ë°˜ë°œê³„ìˆ˜ ë³€í™”ë¥¼ ë°˜ì˜

  ```python
  final_submission['OPS'] = final_submission['OPS'] - 0.038
  display(final_submission.head(10))
  final_submission.to_csv('submission.csv', index=False) # ìµœì¢… ì œì¶œíŒŒì¼ ìƒì„±
  ```

      C:\Users\kimminsung\AppData\Roaming\Python\Python36\site-packages\ipykernel_launcher.py:1: SettingWithCopyWarning: 
      A value is trying to be set on a copy of a slice from a DataFrame.
      Try using .loc[row_indexer,col_indexer] = value instead
      
      See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
        """Entry point for launching an IPython kernel.

  

  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }


      .dataframe tbody tr th {
          vertical-align: top;
      }
      
      .dataframe thead th {
          text-align: right;
      }

  </style>

  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>batter_id</th>
        <th>batter_name</th>
        <th>OPS</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>1</td>
        <td>ê°•ê²½í•™</td>
        <td>0.465957</td>
      </tr>
      <tr>
        <th>1</th>
        <td>2</td>
        <td>ê°•êµ¬ì„±</td>
        <td>0.649933</td>
      </tr>
      <tr>
        <th>2</th>
        <td>3</td>
        <td>ê°•ë¯¼êµ­</td>
        <td>0.658609</td>
      </tr>
      <tr>
        <th>3</th>
        <td>4</td>
        <td>ê°•ë¯¼í˜¸</td>
        <td>0.920395</td>
      </tr>
      <tr>
        <th>4</th>
        <td>5</td>
        <td>ê°•ë°±í˜¸</td>
        <td>0.713592</td>
      </tr>
      <tr>
        <th>5</th>
        <td>8</td>
        <td>ê°•ìƒì›</td>
        <td>0.623807</td>
      </tr>
      <tr>
        <th>6</th>
        <td>9</td>
        <td>ê°•ìŠ¹í˜¸</td>
        <td>0.467642</td>
      </tr>
      <tr>
        <th>7</th>
        <td>11</td>
        <td>ê°•ì§„ì„±</td>
        <td>0.618007</td>
      </tr>
      <tr>
        <th>8</th>
        <td>12</td>
        <td>ê°•í•œìš¸</td>
        <td>0.634859</td>
      </tr>
      <tr>
        <th>9</th>
        <td>16</td>
        <td>ê³ ëª…ì„±</td>
        <td>0.602507</td>
      </tr>
    </tbody>
  </table>

  </div>

* 2019ë…„ ê³µì¸êµ¬ ë°˜ë°œê³„ìˆ˜ ë³€í™”ê¹Œì§€ ë°˜ì˜í•´ ìµœì¢… ì˜ˆì¸¡ê°’ì„ ë„ì¶œ

* ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ë¬¼ì€ `final_submission`ì´ë¼ëŠ” ì´ë¦„ì˜ ë°ì´í„°í”„ë ˆì„ì— ì €ì¥

* `final_submission`ì„ submission.csvë¡œ ì €ì¥í•´ ë°ì´ì½˜ì— ì œì¶œ

## 6_ ì •ë¦¬[ğŸ“‘](#contents)<a id='6'></a>

* ì§€ê¸ˆê¹Œì§€ ê²½ì§„ëŒ€íšŒ ê°œìš” íŒŒì•…, íƒìƒ‰ì  ë°ì´í„° ë¶„ì„, ë°ì´í„° ì „ì²˜ë¦¬, ëª¨ë¸ êµ¬ì¶•ê³¼ ê²€ì¦, ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ê¸°ë²•ì„ ì ìš©í•´ ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ë¬¼ì„ ë§Œë“¦
* ê²½ì§„ëŒ€íšŒ ê°œìš”ë¥¼ í†µí•´ ìš”êµ¬ì‚¬ í•­ íŒŒì•…í•˜ê¸°ë¥¼ ì‹œì‘ìœ¼ë¡œ íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ì„ í†µí•œ ì „ì²´ ë¶„ì„ ì „ëµ ìˆ˜ë¦½, ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ í†µí•œ í•„ìš” ë°ì´í„° ì •ì œ, ëª¨ë¸ë§ì„ í†µí•œ ë¨¸ì‹ ëŸ¬ë‹ ìˆ˜í–‰, ì„±ëŠ¥ í–¥ìƒ ê¸°ë²•ì„ í†µí•œëª¨ë¸ ì„±ëŠ¥ ê³ ë„í™”ê¹Œì§€ì˜ ì‘ì—…ì„ ì§„í–‰
* ì´ëŸ¬í•œ ì ˆì°¨ëŠ” ì´ë²ˆ ëŒ€íšŒë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ì–‘í•œ ë°ì´í„° ë¶„ì„ ëŒ€ íšŒì— ëª¨ë‘ ì ìš© ê°€ëŠ¥ 
* ë‹¨ê³„ë³„ë¡œ ì´ë²ˆ ì˜ˆì œì—ì„œ íŒŒì•…í•˜ì§€ ëª»í–ˆë˜ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ë°œê²¬í•˜ê±°ë‚˜ ë¶„ì„ ì „ëµì— ìˆì–´ ì°½ì˜ ì ì¸ ì•„ì´ë””ì–´ë¥¼ ê°œë°œí•œë‹¤ë©´ ì˜ˆì œë³´ë‹¤ ë” ì„±ëŠ¥ ì¢‹ì€ ëª¨ë¸ì„ ê°œë°œí•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€
* ìì‹ ë§Œ ì˜ ë¶„ì„ ë…¼ë¦¬ë¥¼ ë§Œë“¤ì–´ ì´ë¥¼ ì‹¤ì œë¡œ êµ¬í˜„í•œ í›„ ê·¸ ê²°ê³¼ë¥¼ ë³¸ ì˜ˆì œì™€ ë¹„êµí•´ë³¸ë‹¤ë©´ ë” ìœ ìµí•˜ ê²Œ ë°ì´í„° ë¶„ì„ ì—­ëŸ‰ì„ ìŒ“ì„ìˆ˜ ìˆìŒ
